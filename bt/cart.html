<!doctype html>
<html lang="en">
    <head>
        <title>Your Cart</title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <style>
            html, body {
                height: 100%;
                margin: 0;
            }

            body {
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                min-height: 100vh;
            }

            /* Navigation */
            #navbar_home a {
                text-decoration: none;
                color: white;
            }
            #navbar_home a:hover {
                text-decoration: none;
                color: #ddd;
                font-weight: bold;
            }

            #login_register a {
                text-decoration: none;
                color: white;
            }
            #login_register a:hover {
                text-decoration: none;
                color: #ddd;
                font-weight: bold;
            }

            .cart-container {
                max-width: 1200px;
                margin: 30px auto;
                padding: 20px;
            }

            .cart-header {
                background: white;
                border-radius: 10px;
                padding: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                margin-bottom: 30px;
            }

            .cart-item {
                background: white;
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                transition: transform 0.3s ease;
            }

            .cart-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            }

            .cart-item-img {
                width: 120px;
                height: 120px;
                object-fit: cover;
                border-radius: 10px;
            }

            .quantity-controls {
                display: flex;
                align-items: center;
                border: 1px solid #dee2e6;
                border-radius: 8px;
                padding: 5px 10px;
                width: fit-content;
            }

            .quantity-btn {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                border: none;
                background-color: #f8f9fa;
                color: #333;
                font-weight: bold;
                transition: all 0.2s ease;
            }

            .quantity-btn:hover {
                background-color: #e9ecef;
            }

            .quantity-value {
                font-weight: 600;
                font-size: 1.1rem;
                margin: 0 15px;
                min-width: 30px;
                text-align: center;
            }

            .summary-card {
                background: white;
                border-radius: 10px;
                padding: 25px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                position: sticky;
                top: 20px;
            }

            .summary-item {
                display: flex;
                justify-content: space-between;
                margin-bottom: 15px;
                padding-bottom: 10px;
                border-bottom: 1px solid #eee;
            }

            .total-price {
                font-size: 1.5rem;
                font-weight: bold;
                color: #ff6b6b;
            }

            .empty-cart {
                text-align: center;
                padding: 50px 20px;
            }

            .empty-cart-icon {
                font-size: 5rem;
                color: #dee2e6;
                margin-bottom: 20px;
            }

            .btn-checkout {
                background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
                border: none;
                padding: 12px;
                font-weight: bold;
                font-size: 1.1rem;
                transition: all 0.3s ease;
            }

            .btn-checkout:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
            }

            .remove-item {
                color: #ff6b6b;
                cursor: pointer;
                transition: color 0.2s ease;
            }

            .remove-item:hover {
                color: #ff5252;
            }

            .item-name {
                font-weight: 600;
                font-size: 1.1rem;
                color: #333;
            }

            .item-price {
                color: #ff6b6b;
                font-weight: 600;
            }

            @media (max-width: 768px) {
                .cart-item-img {
                    width: 100%;
                    height: 200px;
                    margin-bottom: 15px;
                }
            }
        </style>
    </head>

    <body>
        <header>
            <nav>
                <div class="container-fluid text-white p-3" style="background-color: rgb(13, 13, 13);">
                    <div><a href="home.html"><img src="" alt="logo" height="50px" width="50px"></a></div>
                    <h1 class="text-center">Your Shopping Cart</h1>
                    <div class="d-flex justify-content-center align-items-center" id="navbar_home">
                        <div><a href="home.html" class="ms-3 bi bi-house">Home</a></div>
                        <div><a href="cart.html" class="ms-3 bi bi-cart">Cart</a></div>
                        <div><a href="" class="ms-3 bi bi-person-plus">Contact</a></div>
                    </div>
                    <div class="d-flex justify-content-end align-items-end" id="login_register">
                        <a href="login.html" class="ms-3">Login</a>
                        <a href="register.html" class="ms-3">Register</a>
                    </div>
                </div>
            </nav>
        </header>

        <main>
            <div class="cart-container">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="cart-header">
                            <h2 class="mb-0"><i class="bi bi-cart3"></i> Shopping Cart</h2>
                        </div>

                        <!-- Cart Items will be loaded here -->
                        <div id="cart-items-container">
                            <!-- Items will be dynamically loaded -->
                        </div>

                        <!-- Empty Cart Message -->
                        <div id="empty-cart-message" class="empty-cart" style="display: none;">
                            <div class="empty-cart-icon">
                                <i class="bi bi-cart-x"></i>
                            </div>
                            <h3>Your cart is empty</h3>
                            <p class="text-muted">Add some delicious items from our menu!</p>
                            <a href="home.html" class="btn btn-primary mt-3">
                                <i class="bi bi-arrow-left"></i> Continue Shopping
                            </a>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="summary-card">
                            <h4 class="mb-4">Order Summary</h4>
                            
                            <div class="summary-item">
                                <span>Subtotal</span>
                                <span id="subtotal">Rs:0.00</span>
                            </div>
                            
                            <div class="summary-item">
                                <span>Shipping</span>
                                <span id="shipping">Rs:2.99</span>
                            </div>
                            
                            <div class="summary-item">
                                <span>Tax</span>
                                <span id="tax">Rs:0.00</span>
                            </div>
                            
                            <div class="summary-item total-price">
                                <span>Total</span>
                                <span id="total">Rs:0.00</span>
                            </div>
                            
                            <button id="checkout-btn" class="btn btn-checkout btn-lg w-100 mt-4" disabled>
                                <i class="bi bi-lock"></i> Proceed to Checkout
                            </button>
                            
                            <div class="text-center mt-3">
                                <a href="home.html" class="text-decoration-none">
                                    <i class="bi bi-arrow-left"></i> Continue Shopping
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <!-- Footer content -->
        </footer>

        <!-- JavaScript Libraries -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>

        <script>
    // Cart data structure
    const defaultCartItems = {
        burger: { 
            id: 'burger',
            name: 'Idli',
            price: 60,
            originalPrice: 80,
            quantity: 0,
            image: 'img/dosa1.jpg',
            description: 'Light and easy to digest, Good for gut health'
        },
        pizza: { 
            id: 'pizza',
            name: 'Pepperoni Pizza',
            price: 16.50,
            originalPrice: 19.99,
            quantity: 0,
            image: 'https://images.unsplash.com/photo-1513104890138-7c749659a591',
            description: 'Classic pizza with mozzarella cheese and pepperoni'
        },
        salad: { 
            id: 'salad',
            name: 'Caesar Salad',
            price: 10.99,
            originalPrice: 10.99,
            quantity: 0,
            image: 'https://images.unsplash.com/photo-1559715745-e1b33a271c8f',
            description: 'Fresh romaine lettuce with Caesar dressing'
        },
        ice: { 
            id: 'ice',
            name: 'Ice Cream',
            price: 3.99,
            originalPrice: 4.99,
            quantity: 0,
            image: 'https://images.unsplash.com/photo-1565958011703-44f9829ba187',
            description: 'Vanilla ice cream with chocolate sauce'
        },
        juice: { 
            id: 'juice',
            name: 'Fresh Juice',
            price: 5.99,
            originalPrice: 6.99,
            quantity: 0,
            image: 'https://images.unsplash.com/photo-1565958011703-44f9829ba187',
            description: 'Fresh orange juice'
        },
        cake: { 
            id: 'cake',
            name: 'Chocolate Cake',
            price: 8.99,
            originalPrice: 10.99,
            quantity: 0,
            image: 'https://images.unsplash.com/photo-1565958011703-44f9829ba187',
            description: 'Rich chocolate cake with frosting'
        }
    };

    // Load cart from localStorage
    function loadCartFromStorage() {
        const savedCart = localStorage.getItem('foodCart');
        let cart = [];
        
        if (savedCart) {
            const parsedCart = JSON.parse(savedCart);
            console.log('Loaded cart:', parsedCart);
            
            // Convert the stored cart object to array
            Object.keys(parsedCart).forEach(itemKey => {
                if (parsedCart[itemKey].quantity > 0) {
                    cart.push({
                        id: itemKey,
                        name: parsedCart[itemKey].name || defaultCartItems[itemKey]?.name || itemKey,
                        price: parsedCart[itemKey].price || defaultCartItems[itemKey]?.price || 0,
                        originalPrice: defaultCartItems[itemKey]?.originalPrice || parsedCart[itemKey].price || 0,
                        quantity: parsedCart[itemKey].quantity,
                        image: parsedCart[itemKey].image || defaultCartItems[itemKey]?.image || '',
                        description: defaultCartItems[itemKey]?.description || ''
                    });
                }
            });
        }
        
        return cart.length > 0 ? cart : [];
    }

    // Initialize cart on page load
    let cart = [];

    document.addEventListener('DOMContentLoaded', function() {
        cart = loadCartFromStorage();
        console.log('Cart initialized:', cart);
        renderCart();
        updateSummary();
        updateCartCount();
    });

    // Render cart items
    function renderCart() {
        const cartContainer = document.getElementById('cart-items-container');
        const emptyCartMessage = document.getElementById('empty-cart-message');
        
        if (cart.length === 0) {
            cartContainer.innerHTML = '';
            emptyCartMessage.style.display = 'block';
            return;
        }
        
        emptyCartMessage.style.display = 'none';
        
        let cartHTML = '';
        
        cart.forEach((item, index) => {
            const itemTotal = item.price * item.quantity;
            const discount = item.originalPrice > item.price ? 
                Math.round(((item.originalPrice - item.price) / item.originalPrice) * 100) : 0;
            
            cartHTML += `
                <div class="cart-item" data-item-id="${item.id}">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="${item.image}" class="cart-item-img" alt="${item.name}" onerror="this.src='https://via.placeholder.com/300x200?text=Food+Image'">
                        </div>
                        <div class="col-md-6">
                            <h4 class="item-name">${item.name}</h4>
                            <p class="text-muted mb-2">${item.description}</p>
                            
                            <div class="d-flex align-items-center mb-3">
                                <span class="item-price me-3">Rs:${item.price.toFixed(2)}</span>
                                ${discount > 0 ? `
                                    <span class="text-muted text-decoration-line-through me-2">Rs:${item.originalPrice.toFixed(2)}</span>
                                    <span class="badge bg-success">${discount}% OFF</span>
                                ` : ''}
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="quantity-controls">
                                    <button class="quantity-btn" onclick="decreaseQuantity(${index})">
                                        <i class="bi bi-dash-lg"></i>
                                    </button>
                                    <span class="quantity-value">${item.quantity}</span>
                                    <button class="quantity-btn" onclick="increaseQuantity(${index})">
                                        <i class="bi bi-plus-lg"></i>
                                    </button>
                                </div>
                                <button class="btn btn-link remove-item ms-4" onclick="removeItem(${index})">
                                    <i class="bi bi-trash"></i> Remove
                                </button>
                            </div>
                        </div>
                        <div class="col-md-3 text-end">
                            <h5 class="item-price">Rs:${itemTotal.toFixed(2)}</h5>
                        </div>
                    </div>
                </div>
            `;
        });
        
        cartContainer.innerHTML = cartHTML;
    }

    // Update quantity functions
    function increaseQuantity(index) {
        cart[index].quantity++;
        saveCart();
        renderCart();
        updateSummary();
        updateCartCount();
    }

    function decreaseQuantity(index) {
        if (cart[index].quantity > 1) {
            cart[index].quantity--;
            saveCart();
            renderCart();
            updateSummary();
            updateCartCount();
        }
    }

    // Remove item from cart
    function removeItem(index) {
        if (confirm('Are you sure you want to remove this item from your cart?')) {
            cart.splice(index, 1);
            saveCart();
            renderCart();
            updateSummary();
            updateCartCount();
        }
    }

    // Update order summary
    function updateSummary() {
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const shipping = subtotal > 0 ? 2.99 : 0;
        const tax = subtotal * 0.08; // 8% tax
        const total = subtotal + shipping + tax;
        
        document.getElementById('subtotal').textContent = `Rs:${subtotal.toFixed(2)}`;
        document.getElementById('shipping').textContent = `Rs:${shipping.toFixed(2)}`;
        document.getElementById('tax').textContent = `Rs:${tax.toFixed(2)}`;
        document.getElementById('total').textContent = `Rs:${total.toFixed(2)}`;
        
        // Enable/disable checkout button
        const checkoutBtn = document.getElementById('checkout-btn');
        checkoutBtn.disabled = cart.length === 0;
    }

    // Save cart to localStorage
    function saveCart() {
        // Convert cart array back to object format for storage
        const cartForStorage = {};
        cart.forEach(item => {
            cartForStorage[item.id] = {
                quantity: item.quantity,
                price: item.price,
                name: item.name,
                image: item.image
            };
        });
        
        localStorage.setItem('foodCart', JSON.stringify(cartForStorage));
        console.log('Cart saved to localStorage:', cartForStorage);
    }

    // Update cart count in navbar
    function updateCartCount() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        
        let cartCountBadge = document.getElementById('cart-count-badge');
        if (!cartCountBadge) {
            cartCountBadge = document.createElement('span');
            cartCountBadge.id = 'cart-count-badge';
            cartCountBadge.className = 'badge bg-danger rounded-pill position-absolute top-0 start-100 translate-middle';
            cartCountBadge.style.fontSize = '0.7rem';
            
            const cartLink = document.querySelector('a[href="cart.html"]');
            if (cartLink) {
                cartLink.style.position = 'relative';
                cartLink.appendChild(cartCountBadge);
            }
        }
        
        cartCountBadge.textContent = totalItems;
        if (totalItems === 0) {
            cartCountBadge.style.display = 'none';
        } else {
            cartCountBadge.style.display = 'inline-block';
        }
    }

    // Checkout button handler
    document.getElementById('checkout-btn').addEventListener('click', function() {
        if (cart.length === 0) return;
        
        // Prepare checkout data
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const shipping = 2.99;
        const tax = subtotal * 0.08;
        const total = subtotal + shipping + tax;
        
        // Save checkout data to localStorage
        localStorage.setItem('checkoutData', JSON.stringify({
            cart: cart,
            total: total.toFixed(2),
            subtotal: subtotal.toFixed(2),
            shipping: shipping.toFixed(2),
            tax: tax.toFixed(2)
        }));
        
        // Redirect to checkout page
        window.location.href = 'checkout.html';
    });

    // Clear cart function
    function clearCart() {
        if (confirm('Are you sure you want to clear your entire cart?')) {
            cart = [];
            localStorage.removeItem('foodCart');
            renderCart();
            updateSummary();
            updateCartCount();
            alert('Cart cleared!');
        }
    }

    // Add clear cart button for testing
    document.addEventListener('DOMContentLoaded', function() {
        if (cart.length > 0) {
            const cartHeader = document.querySelector('.cart-header');
            const clearBtn = document.createElement('button');
            clearBtn.className = 'btn btn-sm btn-outline-danger mt-2';
            clearBtn.innerHTML = '<i class="bi bi-trash"></i> Clear Cart';
            clearBtn.onclick = clearCart;
            cartHeader.appendChild(clearBtn);
        }
    });
</script>
    </body>
</html>